package main

import (
	"fmt"
	"math/rand/v2"
	"strings"
	"time"

	"github.com/nanachi-sh/go-mc/bot"
	"github.com/nanachi-sh/go-mc/bot/parse"
)

func main() {
	// cli, err := bot.NewClient("localhost:26566", bot.WithForge(
	// 	"9414170852454749535445520a08464d4c7c485300464d4c00706572736f6e616c73706163655f6576656e74004269626c696f54797065466c61670050726f6a5265647c457870616e73696f6e006164764261636b7061636b4368616e00647265616d6372616674006b75626174656368004269626c696f5265636970654372616674006763652e70726f6a656374626c7565006f70656e676c6173736573004269626c696f52426f6f6b00626277616e64730042696f6d65734f506c656e7479004943324e43004d42327c536869656c64466c617368005243004d427c4c6f67696e0042515f4e45545f4348414e006f70656e6d6f64756c617274757272657473006d616c69736973646f6f727300686f646765706f64676500466f7267654d756c746970617274004269626c696f5061696e745072657373006d616c69736973636f72650061653266630053746f726167654472617765727300626f74616e696100656e68616e6365646c6f6f74626167730042432d434f4d504154007574696c69746965735f6d795f7465616d0042432d53494c49434f4e00696332004269626c696f4d434250616765004269626c696f5061696e74696e674300464d4c006d6f64756c61727569007365727665727574696c6974696573007574696c69746965735f636c61696d00744578706c6f726174696f6e00616d756e726124636f6e6e656374696f6e00436f464800687964726f656e65726779004269626c696f54797065004269626c696f436c6f636b006175746f6d616779004c6f67697374696373506970657300776f726c645f696e666f0042432d464143544f5259005761696c61004d42327c5769656c6453657400576172705468656f7279004145320067616c616374696372616674004269626c696f436c6970426c6f636b007463696e76656e746f72797363616e004542004269626c696f4472696c6c54657874006e617475726573636f6d7061737300426c6f6f644d616769630044756d6d79436f726500426574746572416368696576656d656e7473004d42327c506c61636500464f52007574696c69746965735f7374617473004269626c696f41746c61735750540066696e64697400454d5400455300455400536967696c4f66486f6c64696e6700686172766573747468656e6574686572004d42327c486572616c64727900476f6f6447656e657261746f7200464f52474500546861756d696354696e6b657265727c420043617270656e74657273426c6f636b73004269626c696f52656369706554657874005472616e736c6f6361746f72004f70656e4d6f64737c4d004f70656e4d6f64737c49006d6973637574696c73004d72544a50436f72654d6f64004f70656e4d6f64737c45004f70697300746861756d6963656e657267697374696373006c6f6f7467616d657332006d6f6273696e666f0042515f5354414e44415244004d696e65547765616b657233006f70656e7072696e74657200626465772e6e65696164646f6e73004269626c696f557064617465496e76007374727563747572656c696200496e76656e746f7279547765616b730042494e0054726176656c6c65727347656172004175676d656e746564486f6c64696e67006761646f6d616e637900696e67616d65696e666f786d6c00626574746572703270004269626c696f41746c6173544755490050726f6a5265647c436f7265006d7872616e646f6d0050527c5472616e737000466c6f6f644c6967687473004172636869746563747572654372616674004d42327c416e696d6174696f6e00686f6c6f696e76656e746f72790052494f006966750047616c616374696372616674436f72650070726f6a656374626c75652e6461746100746334747765616b004d42327c475549004772656754656368006865650057435400466f7267654d6963726f626c6f636b004445766f6c7574696f6e4e43005a746f6e657300626465772e6d756c7469626c6f636b004d61676963426565730042432d5452414e53504f52540050726f6a5265647c496e746567726174696f6e004465747261765363616e6e6572004269626c696f41746c617300636f6f6b696e67666f72626c6f636b6865616473006d6f64756c617275693200534d7c4558004d42327c437265615069636b004269626c696f54797065557064617465004f70656e436f6d707574657273004d634d756c74697061727400616d756e72612467656e657269630058557c506b7400746861756d62617365730047454e00746861756d637261667400466163746f72794d616e6167657200656e6465727a6f6f00617661726974696164646f6e73006d617a656d6170004d42327c53796e634974656d004269626c696f50616e656c65720048617264636f72654461726b6e6573730074696e6b657273646566656e7365006d616769636d617000416476536f6c617250616e656c73004a4142424100626465772e61653273747566660072616e646f6d7468696e6773004170706c65436f7265004f70656e53656375726974790067746e686c6962004269626c696f52426f6f6b4c6f61640076697375616c70726f7370656374696e67004269626c696f53746f636b436f6d70617373004d42327c5370656369616c004269626c696f41746c6173535750004e454900706572736f6e616c7370616365004269626c696f4d65617375726500466f72676552656c6f636174696f6e0054436f6e737472756374004269626c696f5061696e74696e6700456e646572436f7265004f70656e4d6f64737c52504300617369656c6962007368617265776865726569616d004d42327c42616e6e6572007461696e7465646d6167696300544d656368576f726b7300444e4d4e6574776f726b00534743726166740042432d454e4552475900424f5400686172766573746372616674004269626c696f53746f636b5469746c65005477696c69676874466f7265737400636f6d707574726f6e6963730047726176695375697465006e7574726974696f6e00616c6368656d6963616c77697a617264727900616b6173686963746f6d650061726368616963666978004269626c696f4f70656e426f6f6b006e65656e657267697374696373007574696c69746965735f66696c657300626175626c65730049726f6e4368657374004269626c696f53746f636b4c6f670053706963654f664c696665004269626c696f415374616e640043726561746976654d445061636b657400656e646572696f004269626c696f5479706544656c65746500746861756d6963626f6f7473007574696c69746965735f636f6e6669670042432d434f524500534332004269626c696f4d617050696e00736368656d6174696361004d42327c426c6f636b004269626c696f4d4342456469740063686973656c005374657665734164646f6e73004269626c696f5369676e0041535f4946004261636b7061636b007769746368657279005769746368696e6747616467657473005752434245007465637465636800746861756d6963686f72697a6f6e73",
	// 	"ed341706464d4c7c48531a6302b302124275696c6443726166747c53696c69636f6e06372e312e34321150726f6a5265647c457870616e73696f6e0b342e31312e302d47544e480945787472614265657305322e342e381648617264636f7265456e646572457870616e73696f6e0b312e31322e312d47544e480c626c6f636b6c696d6974657205302e362e300b4d6f757365547765616b730b322e342e32302d47544e4806426f74616e7905322e342e380a647265616d637261667407322e362e31303109656e646572636f726505302e342e361174726176656c6c657273676561726e656f03312e30116d6978696e626f6f7465726c656761637905312e322e31134275696c6443726166747c526f626f7469637306372e312e3432086b756261746563680b352e30392e35302e31313908616e67656c6963610c312e302e302d6265746132390869726f6e74616e6b05312e332e3008666f7267656c696e0b312e31302e302d47544e480c67616c6163746963677265670b352e30392e35302e313139064963324e656905312e322e310b6f70656e676c61737365730a312e352e312d47544e480b47616c61787953706163650b312e312e39392d47544e48136265747465726275696c6465727377616e64730b302e31332e312d47544e480d42696f6d65734f506c656e747905322e312e300d4c756e617472697573436f72650a312e322e312d47544e480d626574746572637261736865730a312e342e302d47544e480b67746e68746377616e647305312e342e31126f70656e6d6f64756c61727475727265747305322e332e370a686f646765706f64676506322e352e39300e466f7267654d756c74697061727405312e362e32096c6f6f7467616d657305322e312e340c6d616c69736973646f6f72730b312e31382e302d47544e4809656d6265646469756d0c312e302e302d6265746132390962657272696573707006312e372e31340c4272616e646f6e73436f72650a312e322e302d47544e4808436f4648436f72650c312e372e313052332e312e340b6d616c69736973636f72650b312e31382e302d47544e480863617477616c6b7305322e302e340b64656661756c746b65797305312e332e300a4578747261547265657305322e342e3806706f7374656106312e302e31330561653266630b312e332e35352d67746e680e53746f72616765447261776572730a322e312e302d47544e480967656e6475737472790a312e392e302d47544e4810656e68616e6365646c6f6f746261677305312e312e320a5447726567776f726b7312312e372e31302d47544e482d312e302e32380c47544e484c696220436f726506302e352e3233114275696c6443726166747c456e6572677906372e312e34320b6d6f64747765616b65723206302e31312e300349433214322e322e3832382d6578706572696d656e74616c1257697463686572794578747261735f41534d08302e312d4265746116496775616e61547765616b7354436f6e73747275637405322e362e3003464d4c0a372e31302e39392e3939064e617475726105322e372e36096d6f64756c6172756906312e322e31381164656661756c747365727665726c69737405312e352e30124e45494164646f6e737c466f72657374727906312e31362e300f7365727665727574696c697469657306322e312e3430085468452d636f726507312e302e302e31114269626c696f576f6f64734e617475726103312e350a3c436f46482041534d3e03303030084175746f6d61677906302e32382e3206756e696c696205312e302e351450726f6a5265647c496c6c756d696e6174696f6e0b342e31312e302d47544e480b687964726f656e6572677905312e342e330a544d656368776f726b7305302e342e300e4c6f6769737469637350697065730a312e332e362d47544e4811746861756d6963696e73757267656e636505302e332e3110426175626c65737c457870616e64656405322e302e330e4e6f74456e6f7567684974656d730b322e362e35342d47544e480a546861756d637261667407342e322e332e350c6f70656e73656375726974790a312e322e302d47544e48055761696c6105312e382e3212657465726e616c73696e67756c617269747905312e322e3109506c6179657241504905312e352e3010756e696d6978696e732d636f6d70617406302e312e3139186170706c696564656e657267697374696373322d636f7265117276332d626574612d3438352d47544e48096e6176696761746f7206312e302e3135094e45494164646f6e7306312e31362e301653746f7261676544726177657273466f7265737472790a322e312e302d47544e480b4269626c696f437261667406312e31312e370a576172705468656f72790a312e342e332d47544e480f4275696c6443726166747c436f726506372e312e34320e637573746f6d6d61696e6d656e7506312e31312e330c4f70656e4d6f6473436f726506302e31302e39136265747465726c6f6164696e6773637265656e0a312e372e302d47544e480562646c69620b312e31302e302d47544e48134e45494164646f6e737c446576656c6f70657206312e31362e300f7463696e76656e746f72797363616e0a312e322e302d47544e481450726f6a5265647c5472616e736d697373696f6e0b342e31312e302d47544e480e6e617475726573636f6d706173730a312e352e302d47544e480c57522d4342457c4c6f67696305312e372e300944756d6d79436f726506312e31392e300e576974636865727945787472617305312e332e30035257470b616c7068612d312e352e3012426574746572416368696576656d656e747305302e332e300a4d6f62697573436f72650d312e342e352d6d61706c6573730f696e76656e746f7279747765616b7305312e372e311564656661756c74776f726c6467656e657261746f7205302e332e300d496e47616d65496e666f584d4c06322e382e323003454d5406312e352e31370666696e64697406312e332e31300a4f70656e426c6f636b730b312e31312e332d47544e4810686172766573747468656e657468657206312e372e31300d476f6f6447656e657261746f720b352e30392e35302e3131390a67617373746174696f6e05302e352e310e466f7262696464656e4d616769630a302e372e312d47544e480c456e64657253746f7261676505312e372e3209616c636867726174650a312e322e312d47544e48086772656774656368064d43313731300f43726f704c6f6164436f726541534d05302e302e321043617270656e74657273426c6f636b730a332e362e342d47544e4807456e646572494f06322e382e323411626c6f636b72656e64657265723633343306312e322e31360c5472616e736c6f6361746f7205312e332e300c496e6665726e616c4d6f62730a312e392e322d47544e480e6e6569696e746567726174696f6e05312e342e30096d6973637574696c730b352e30392e35302e3131390c4d72544a50436f72654d6f6405312e322e3109526f6775656c696b650a312e362e302d47544e480e6d6370617463686572666f7267650b312e302e302d616c7068610b5370656369616c4d6f627305332e362e32104e45494164646f6e737c426f74616e7906312e31362e30044f7069730d312e342e352d6d61706c6573730b736c656570696e6762616705302e332e3012746861756d6963656e6572676973746963730b312e362e32372d47544e480967746e686c616e74680b352e30392e35302e3131390f436f6465436869636b656e436f726505312e342e31086d6f6273696e666f0a302e342e372d47544e480759414d436f726505302e362e300c4d696e65547765616b65723305332e342e300b6f70656e7072696e7465720a302e332e302d47544e48094754547765616b657205322e322e3419546861756d696354696e6b657265722d7072656c6f6164657203302e31056f617574680a312e332e332d47544e480c7374727563747572656c696205312e332e360962617274776f726b730b352e30392e35302e3131390a67746e686d6978696e7305322e322e300e4e6f64616c4d656368616e6963730a312e332e302d47544e480e54726176656c6c6572734765617206312e31362e3611616476656e747572656261636b7061636b0a312e332e352d47544e480e67746e65696f7265706c7567696e0b352e30392e35302e313139096761646f6d616e637905312e332e380962657474657270327005312e332e3007426175626c657305322e302e330c50726f6a5265647c436f72650b342e31312e302d47544e481167746e68696e74657267616c616374696306312e342e3335086d7872616e646f6d05302e342e370b466c6f6f644c696768747305312e342e3603544d4c0a342e322e302d47544e4811417263686974656374757265437261667406312e31302e321350726f6a5265647c4578706c6f726174696f6e0b342e31312e302d47544e481453746f72616765447261776572734572656275730a322e312e302d47544e480d686f6c6f696e76656e746f72790a322e352e302d47544e480661653277637406312e31312e3708466f72657374727906342e392e32320a536368656d61746963610b312e31322e322d47544e48084f70656e4d6f647306302e31302e390369667506312e31312e310352494f05322e372e340e74636e65696164646974696f6e7305312e342e381047616c616374696372616674436f72650b332e322e31302d47544e480e4269626c696f576f6f6473426f5003312e390d746f726f6865616c74686d6f6405312e312e30066e656368617211312e372e31302d312e352e342d47544e4808746334747765616b06312e352e32380d74636e6f6465747261636b657205312e332e320f6e6574686572706f7274616c66697805312e332e30097175657374626f6f6b0b332e362e32342d47544e480b626174746c65676561723205312e342e320f466f7267654d6963726f626c6f636b05312e362e320f626f74616e6963686f72697a6f6e730a312e312e372d47544e48065a746f6e657306312e372e313012546861756d69634578706c6f726174696f6e0a312e342e302d47544e480b64757261646973706c617905312e332e3408456e6465725a6f6f05312e332e31094d61676963426565730a322e392e312d47544e481350726f6a5265647c496e746567726174696f6e0b342e31312e302d47544e480e6265747465727175657374696e670b332e362e32342d47544e480b636f6e74726f6c6c696e6705322e312e3214636f6f6b696e67666f72626c6f636b68656164730a312e332e382d47544e480874786c6f6164657205312e372e3318636f6d706163746b696e6574696367656e657261746f72730a312e372e31302d312e30046e65696405322e312e360861653273747566660a302e382e362d47544e480b6d6978696e65787472617306302e312e31390a6d6f64756c61727569320d322e312e31362d312e372e31300d4f70656e436f6d7075746572730c312e31302e33302d47544e480b4d634d756c74697061727405312e362e32086b656b7a746563680b352e30392e35302e3131390d677261766973756974656e656f05312e322e321350726f6a5265647c4661627269636174696f6e0b342e31312e302d47544e4808537570657254696305312e342e300e45787472615574696c697469657306312e322e3132095261696c637261667407392e31352e31370f616d617a696e6774726f706869657305312e332e30106465747261767363616e6e65726d6f640b352e30392e35302e3131390b62715f7374616e646172640b332e362e32342d47544e480d57522d4342457c4164646f6e7305312e372e30114943324e75636c656172436f6e74726f6c05322e362e370b537465766573436172747305322e332e30084d434672616d657305302e322e310f546861756d6963486f72697a6f6e7305312e372e30134269626c696f576f6f6473466f72657374727903312e371269726f6e63686573746d696e65636172747305312e312e300f737472756374757265636f6d70617405302e362e3505466f7267650c31302e31332e342e313631340d617661726974696164646f6e730a312e382e342d47544e480c63726f706c6f6164636f726505302e322e301048617264636f72654461726b6e65737303312e370e74696e6b657273646566656e736505312e332e31124f70656e436f6d7075746572737c436f72650c312e31302e33302d47544e480f546861756d696354696e6b6572657206322e31302e3218546861756d63726166745265736561726368547765616b7305312e322e30084f696c547765616b05312e312e3112416476616e636564536f6c617250616e656c0c312e372e31302d332e352e3104414653550a312e332e312d47544e48054a4142424105312e342e3708616e6765726d6f6405302e382e321650726f6a5265647c5472616e73706f72746174696f6e0b342e31312e302d47544e48096d6978696e6761736d03302e33094170706c65436f726505332e332e340563623462710b332e362e32342d47544e481162617274776f726b7363726f73736d6f640b352e30392e35302e3131390b546943546f6f6c7469707305312e332e3116756e6976657273616c73696e67756c6172697469657305382e392e300f7375706572736f6c617270616e656c13475241444c45544f4b454e5f56455253494f4e1247616c616374696372616674416d756e526105302e382e310e48756e6765724f7665726861756c17312e372e31302d312e302e302e6a656e6b696e733130340767746e686c696206302e352e32331176697375616c70726f7370656374696e6706312e332e32380e546861756d69634d616368696e6105302e322e31124e45494164646f6e737c45784e6968696c6f06312e31362e30184e45494164646f6e737c4372616674696e675461626c657306312e31362e30135761696c61486172766573746162696c6974790a312e332e322d47544e4809756e696d6978696e7306302e312e313907426f74616e69610b312e31312e372d47544e482462617274776f726b7363726f73736d6f647467726567776f726b73636f6e7461696e65720b352e30392e35302e3131390d706572736f6e616c737061636506312e302e33320f6265656265747465726174626565730a302e342e322d47544e4808417661726974696104312e35390d637261667470726573656e636505322e352e330f466f72676552656c6f636174696f6e05302e322e311550726f6a5265647c436f6d7061746962696c6974790b342e31312e302d47544e480a54436f6e7374727563740c312e31322e31382d47544e4807617369656c696205302e362e3014537465766573466163746f72794d616e616765720a312e332e322d47544e480a42696e6e6965436f726505322e342e380d7368617265776865726569616d05322e312e330d52656c6f636174696f6e464d5005302e322e30057761776c610a312e332e302d47544e480847656e657469637305322e342e38036d637004392e30350f756e696d6978696e732d6d6978696e06302e312e3139064d616e746c6505302e352e300a6a6f75726e65796d617005352e322e38136170706c696564656e65726769737469637332117276332d626574612d3438352d47544e4807534743726166740a312e342e342d47544e4813746861756d63726166746e6569706c7567696e0b312e372e31302d312e376111447261636f6e696345766f6c7574696f6e0b312e332e31382d47544e480b57522d4342457c436f726505312e372e301253746f72616765447261776572734d6973630a322e312e302d47544e480c6861727665737463726166740a312e322e332d47544e480c5461696e7465644d616769630472372e360e5477696c69676874466f7265737406322e362e3337124275696c6443726166747c466163746f727906372e312e34320b50726f6a656374426c75650a312e322e302d47544e480c636f6d707574726f6e6963730a312e382e352d47544e480a477261766953756974650c312e372e31302d322e302e33096e7574726974696f6e06302e302e3133104e45494164646f6e737c417070456e6706312e31362e300b616b6173686963746f6d6505312e322e310a6172636861696366697805302e372e34106e6569637573746f6d6469616772616d05312e362e380a636f7265747765616b7307302e332e332e321047616c6163746963726166744d6172730b332e322e31302d47544e48114275696c6443726166747c436f6d70617406372e312e31370c7761696c61706c7567696e7305302e352e320948656c70466978657205312e332e300d6e65656e65726769737469637305312e372e300b41575761796f6654696d6506312e362e31310949726f6e436865737405362e312e310c6372656174697665636f72650a312e342e302d47544e480c52616e646f6d5468696e677305322e362e3008627567746f7263680b312e322e31342d47544e480c746861756d6963626173657305312e372e380b53706963654f664c6966650d322e312e31322d636172726f740c746861756d6963626f6f747306312e332e313008496e70757446697809312e372e31302d7636076e6f7466696e650c312e302e302d6265746132391453746f72616765447261776572734e61747572610a322e312e302d47544e480c73706f6e67656d6978696e7305322e302e31144275696c6443726166747c5472616e73706f727406372e312e34321153746f7261676544726177657273426f700a322e312e302d47544e480977616e696f6e6c696205312e392e300663686973656c0b322e31352e352d47544e480c5374657665734164646f6e7306302e31342e31084261636b7061636b0a322e342e332d47544e480f546f78696345766572676c616465730b352e30392e35302e31313914546861756d63726166744d6f62417370656374730a312e312e322d47544e4808776974636865727906302e32342e31126f7665726c6f6164656461726d6f7262617205312e312e300f5769746368696e67476164676574730b312e352e31372d47544e48134275696c6443726166747c4275696c6465727306372e312e34320567676661620b352e30392e35302e3131390b63686973656c746f6e65730a312e322e302d47544e480b6c6974746c6574696c65730a312e342e302d47544e4807746563746563680b352e30392e35302e3131390c426c6f6f64417273656e616c05312e332e36",
	// ), bot.WithUsername("Rainy"))
	cli, err := bot.NewClient("localhost:35565", bot.WithForge(
		"2e170852454749535445520022464d4c7c485300464d4c00464d4c00756e6c696d697465646368617400464f524745",
		"4d1706464d4c7c48530043020403464d4c0a372e31302e39392e39390d756e6c696d697465646368617407312e302e362e3105466f7267650c31302e31332e342e31363134036d637004392e3035",
	))
	if err != nil {
		panic(err)
	}
	if err := cli.Dial(); err != nil {
		panic(err)
	}
	fmt.Println(len(randomStr(100)))
	if err := cli.SendMessage(`你好，
高兴见到你`); err != nil {
		panic(err)
	}
	cli.Register(func(sr parse.ServerResponse) {
		if sr.Play.ChatMessage != nil {
			if sr.Play.ChatMessage.Translate == "chat.type.text" {
				fmt.Println(sr.Play.ChatMessage.Json.MarshalString())
			}
		}
	})
	time.Sleep(time.Minute)
}

func randomStr(length int) string {
	dict := []rune("0123456789")
	builder := new(strings.Builder)
	for i := 0; i < length; i++ {
		builder.WriteRune(dict[rand.IntN(len(dict))])
	}
	return builder.String()
}
